<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“ Schnaggi Pong - Multiplayer</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#1a1a2e;display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;font-family:'Segoe UI',sans-serif;color:#fff;overflow:hidden}
h1{font-size:1.8em;margin-bottom:5px;text-shadow:0 0 20px #e94560}
.sub{color:#888;margin-bottom:10px;font-size:0.9em}
#menu{text-align:center;margin:10px}
button{font-size:1.1em;padding:12px 28px;margin:8px;background:#e94560;color:#fff;border:none;border-radius:8px;cursor:pointer}
button:hover{background:#c73e54}
canvas{border:3px solid #e94560;border-radius:8px;background:#16213e}
#scores{font-size:1.5em;margin:10px}
.p1c{color:#0f0}.p2c{color:#e94560}
#gmsg{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2.5em;font-weight:bold;color:#fff;text-shadow:0 0 30px #e94560;pointer-events:none;opacity:0;transition:opacity 0.3s;z-index:10}
#controls{color:#888;font-size:0.9em;margin:8px}
#win{display:none;text-align:center;margin:15px}
#win h2{font-size:2em;color:#e94560;margin-bottom:10px}
</style>
</head>
<body>
<h1>ğŸ“ Schnaggi Pong</h1>
<div class="sub">2 Spieler Â· 1 Tastatur</div>
<div id="scores"><span class="p1c">ğŸŸ¢ Spieler 1: <span id="s1">0</span></span> &nbsp;|&nbsp; <span class="p2c">ğŸ”´ Spieler 2: <span id="s2">0</span></span></div>
<canvas id="game" width="700" height="450"></canvas>
<div id="controls">ğŸŸ¢ Spieler 1: <b>W</b> / <b>S</b> &nbsp;&nbsp;|&nbsp;&nbsp; ğŸ”´ Spieler 2: <b>â†‘</b> / <b>â†“</b></div>
<div id="menu">
<button id="btn-start">START! ğŸ“</button>
</div>
<div id="win">
<h2 id="win-text"></h2>
<button id="btn-restart">Nochmal! ğŸ”„</button>
</div>
<div id="gmsg"></div>

<script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');
const gmsg=document.getElementById('gmsg');
const CW=700,CH=450,PW=14,PH=90,BR=10,WIN_SCORE=7;
const PHRASES=['DIGGA OHNE SCHEISS!','BRUDER WAS?!','ALTER!','SHEEEESH!','VALLAH!','OHHH!','KRANKER MOVE!'];

let p1={y:CH/2-PH/2,score:0,speed:0};
let p2={y:CH/2-PH/2,score:0,speed:0};
let ball={x:CW/2,y:CH/2,vx:0,vy:0};
let keys={},gameOn=false,countdown=0;

function resetBall(dir){
  ball.x=CW/2;ball.y=CH/2;ball.vx=0;ball.vy=0;
  countdown=90; // 1.5 sec at 60fps
  setTimeout(()=>{
    ball.vx=(dir||( Math.random()>0.5?1:-1))*5;
    ball.vy=(Math.random()-0.5)*5;
    countdown=0;
  },1500);
}

function showMsg(t){gmsg.textContent=t;gmsg.style.opacity=1;setTimeout(()=>gmsg.style.opacity=0,1200);}
function randPhrase(){return PHRASES[Math.floor(Math.random()*PHRASES.length)];}

function startGame(){
  document.getElementById('menu').style.display='none';
  document.getElementById('win').style.display='none';
  p1.score=0;p2.score=0;p1.y=CH/2-PH/2;p2.y=CH/2-PH/2;
  updateScores();gameOn=true;
  showMsg("3... 2... 1... LOS!");
  resetBall();
  requestAnimationFrame(loop);
}

function updateScores(){
  document.getElementById('s1').textContent=p1.score;
  document.getElementById('s2').textContent=p2.score;
}

function checkWin(){
  if(p1.score>=WIN_SCORE){
    gameOn=false;
    document.getElementById('win-text').textContent='ğŸŸ¢ SPIELER 1 GEWINNT! ğŸ†';
    document.getElementById('win').style.display='block';
    return true;
  }
  if(p2.score>=WIN_SCORE){
    gameOn=false;
    document.getElementById('win-text').textContent='ğŸ”´ SPIELER 2 GEWINNT! ğŸ†';
    document.getElementById('win').style.display='block';
    return true;
  }
  return false;
}

function loop(){
  if(!gameOn)return;

  // Paddle movement (smooth)
  const spd=6;
  if(keys['w']||keys['W'])p1.y=Math.max(0,p1.y-spd);
  if(keys['s']||keys['S'])p1.y=Math.min(CH-PH,p1.y+spd);
  if(keys['ArrowUp'])p2.y=Math.max(0,p2.y-spd);
  if(keys['ArrowDown'])p2.y=Math.min(CH-PH,p2.y+spd);

  if(countdown<=0){
    // Ball physics
    ball.x+=ball.vx;ball.y+=ball.vy;

    // Top/bottom
    if(ball.y-BR<0){ball.y=BR;ball.vy=Math.abs(ball.vy);}
    if(ball.y+BR>CH){ball.y=CH-BR;ball.vy=-Math.abs(ball.vy);}

    // P1 paddle (left)
    if(ball.x-BR<20+PW&&ball.x-BR>10&&ball.y>p1.y-5&&ball.y<p1.y+PH+5&&ball.vx<0){
      ball.vx=Math.abs(ball.vx)*1.08;
      ball.vy+=(ball.y-(p1.y+PH/2))*0.2;
      ball.x=20+PW+BR;
      showMsg(randPhrase());
    }
    // P2 paddle (right)
    if(ball.x+BR>CW-20-PW&&ball.x+BR<CW-10&&ball.y>p2.y-5&&ball.y<p2.y+PH+5&&ball.vx>0){
      ball.vx=-Math.abs(ball.vx)*1.08;
      ball.vy+=(ball.y-(p2.y+PH/2))*0.2;
      ball.x=CW-20-PW-BR;
      showMsg(randPhrase());
    }

    // Speed cap
    let spd2=Math.sqrt(ball.vx*ball.vx+ball.vy*ball.vy);
    if(spd2>14){ball.vx*=14/spd2;ball.vy*=14/spd2;}

    // Score
    if(ball.x<-20){
      p2.score++;updateScores();
      showMsg('PUNKT FÃœR ROT! ğŸ”´');
      if(!checkWin())resetBall(-1);
    }
    if(ball.x>CW+20){
      p1.score++;updateScores();
      showMsg('PUNKT FÃœR GRÃœN! ğŸŸ¢');
      if(!checkWin())resetBall(1);
    }
  } else {
    countdown--;
  }

  draw();
  requestAnimationFrame(loop);
}

function draw(){
  ctx.clearRect(0,0,CW,CH);

  // Background grid
  ctx.strokeStyle='#1f2b47';ctx.lineWidth=1;
  for(let i=0;i<CW;i+=40){ctx.beginPath();ctx.moveTo(i,0);ctx.lineTo(i,CH);ctx.stroke();}
  for(let i=0;i<CH;i+=40){ctx.beginPath();ctx.moveTo(0,i);ctx.lineTo(CW,i);ctx.stroke();}

  // Center line
  ctx.setLineDash([10,10]);ctx.strokeStyle='#334';ctx.lineWidth=2;
  ctx.beginPath();ctx.moveTo(CW/2,0);ctx.lineTo(CW/2,CH);ctx.stroke();
  ctx.setLineDash([]);

  // Center circle
  ctx.strokeStyle='#334';ctx.beginPath();ctx.arc(CW/2,CH/2,50,0,Math.PI*2);ctx.stroke();

  // Paddles with glow
  ctx.shadowBlur=15;
  ctx.shadowColor='#0f0';ctx.fillStyle='#0f0';
  ctx.fillRect(20,p1.y,PW,PH);
  ctx.shadowColor='#e94560';ctx.fillStyle='#e94560';
  ctx.fillRect(CW-20-PW,p2.y,PW,PH);
  ctx.shadowBlur=0;

  // Ball with trail effect
  ctx.fillStyle='rgba(255,255,255,0.15)';
  ctx.beginPath();ctx.arc(ball.x-ball.vx*2,ball.y-ball.vy*2,BR,0,Math.PI*2);ctx.fill();
  ctx.fillStyle='rgba(255,255,255,0.3)';
  ctx.beginPath();ctx.arc(ball.x-ball.vx,ball.y-ball.vy,BR,0,Math.PI*2);ctx.fill();

  ctx.shadowBlur=10;ctx.shadowColor='#fff';
  ctx.fillStyle='#fff';ctx.beginPath();
  ctx.arc(ball.x,ball.y,BR,0,Math.PI*2);ctx.fill();
  ctx.shadowBlur=0;

  // Schnaggi face on ball
  ctx.fillStyle='#000';
  ctx.fillRect(ball.x-4,ball.y-3,3,3);
  ctx.fillRect(ball.x+1,ball.y-3,3,3);
  ctx.fillRect(ball.x-2,ball.y+2,4,2);

  // Countdown
  if(countdown>0){
    ctx.fillStyle='rgba(255,255,255,0.5)';
    ctx.font='bold 60px sans-serif';ctx.textAlign='center';
    ctx.fillText(Math.ceil(countdown/60),CW/2,CH/2+20);
  }

  // Score display on field
  ctx.fillStyle='rgba(0,255,0,0.08)';ctx.font='bold 120px sans-serif';ctx.textAlign='center';
  ctx.fillText(p1.score,CW/4,CH/2+40);
  ctx.fillStyle='rgba(233,69,96,0.08)';
  ctx.fillText(p2.score,CW*3/4,CH/2+40);
}

document.addEventListener('keydown',e=>{keys[e.key]=true;if(['ArrowUp','ArrowDown'].includes(e.key))e.preventDefault();});
document.addEventListener('keyup',e=>{keys[e.key]=false;});

document.getElementById('btn-start').onclick=startGame;
document.getElementById('btn-restart').onclick=startGame;

// Touch controls for mobile (split screen)
let touch1=null,touch2=null;
canvas.addEventListener('touchstart',e=>{e.preventDefault();},{ passive:false });
canvas.addEventListener('touchmove',e=>{
  e.preventDefault();
  const r=canvas.getBoundingClientRect();
  for(let t of e.touches){
    const x=(t.clientX-r.left)*(CW/r.width);
    const y=(t.clientY-r.top)*(CH/r.height);
    if(x<CW/2) p1.y=Math.max(0,Math.min(CH-PH,y-PH/2));
    else p2.y=Math.max(0,Math.min(CH-PH,y-PH/2));
  }
},{passive:false});
</script>
</body>
</html>
